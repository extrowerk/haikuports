SUMMARY="Free implementation of Windows(tm) on Unix, with Wine-Staging patchset"
DESCRIPTION="Wine is an Open Source implementation of the Windows API on \
top of X and Unix. Think of Wine as a compatibility layer for running \
Windows programs. Wine does not require Microsoft Windows, as it is a \
completely free alternative implementation of the Windows API consisting \
of 100% non-Microsoft code, however Wine can optionally use native Windows \
DLLs if they are available. Wine provides both a development toolkit for \
porting Windows source code to Unix as well as a program loader, allowing \
many unmodified Windows programs to run on x86-based Unixes, including \
Linux, FreeBSD, and Solaris."
HOMEPAGE="https://www.winehq.org/"
COPYRIGHT="1993-2020 the Wine project authors"
LICENSE="GNU LGPL v2.1"
REVISION="1"
srcGitRev="842b38e29166a429d59331be40761335807c85d2"
SOURCE_URI="https://github.com/wine-mirror/wine/archive/$srcGitRev.tar.gz"
CHECKSUM_SHA256="c68f5f50b68cb51c451da7461ac4d6a3b8befc310970c21c5ec694a4673fffdc"
SOURCE_FILENAME="wine-$srcGitRev.tar.gz"
SOURCE_DIR="wine-$srcGitRev"
PATCHES="wine-$portVersion.patchset"

ARCHITECTURES="!x86_gcc2 ?x86 ?x86_64"
SECONDARY_ARCHITECTURES="?x86"

PROVIDES="
	wine$secondaryArchSuffix = $portVersion
	cmd:wine = $portVersion
	"
REQUIRES="
	haiku$secondaryArchSuffix
	"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	"
BUILD_PREREQUIRES="
	cmd:aclocal
	cmd:autoconf
	cmd:bison
	cmd:flex
	cmd:gcc$secondaryArchSuffix
	cmd:m4
	cmd:make
	cmd:pkg_config$secondaryArchSuffix
	"

BUILD()
{
	autoconf

	mkdir -p haiku_build && cd haiku_build

	runConfigure ../configure \
		--without-alsa \
		--without-capi \
		--without-cms \
		--without-coreaudio \
		--without-cups \
		--without-dbus \
		--without-faudio \
		--without-fontconfig \
		--without-freetype \
		--without-gettext \
		--without-gphoto \
		--without-gnutls \
		--without-gsm \
		--without-gssapi \
		--without-gstreamer \
		--without-hal \
		--without-inotify \
		--without-jpeg \
		--without-krb5 \
		--without-ldap \
		--without-mingw \
		--without-mpg123 \
		--without-netapi \
		--without-openal \
		--without-opencl \
		--without-opengl \
		--without-osmesa \
		--without-oss \
		--without-pcap \
		--without-png \
		--without-pthread \
		--without-pulse \
		--without-quicktime \
		--without-sane \
		--without-sdl \
		--without-tiff \
		--without-udev \
		--without-unwind \
		--without-usb \
		--without-v4l2 \
		--without-vkd3d \
		--without-vulkan \
		--without-xcomposite \
		--without-xcursor \
		--without-xfixes \
		--without-xinerama \
		--without-xinput \
		--without-xinput2 \
		--without-xml \
		--without-xrandr \
		--without-xrender \
		--without-xshape \
		--without-xshm \
		--without-xslt \
		--without-xxf86vm \
		--enable-win64 \
		--without-x

	make $jobArgs
}

INSTALL()
{
	make install
}
