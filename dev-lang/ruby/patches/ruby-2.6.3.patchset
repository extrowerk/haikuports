From ebcb94a2c276db8474258326204beca4225afa58 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Zolt=C3=A1n=20Mizsei?= <zmizsei@extrowerk.com>
Date: Fri, 26 Apr 2019 14:56:19 +0200
Subject: =?UTF-8?q?Bugfix.=0AProbably=20Haiku=20doesn't=20allows=20to=20se?=
 =?UTF-8?q?t=20the=20property=20of=20the=20file=20descriptor=20of=20packag?=
 =?UTF-8?q?es=20files..=0ARuby=20DOESN'T=20need=20to=20write=20thoose=20fi?=
 =?UTF-8?q?les!?=


diff --git a/ruby.c b/ruby.c
index 2c8b29a..bff22fc 100644
--- a/ruby.c
+++ b/ruby.c
@@ -2078,6 +2078,7 @@ open_load_file(VALUE fname_v, int *xflag)
 	}
 	rb_update_max_fd(fd);
 
+#ifndef __HAIKU__
 #if defined HAVE_FCNTL && MODE_TO_LOAD != O_RDONLY
 	/* disabling O_NONBLOCK */
 	if (fcntl(fd, F_SETFL, 0) < 0) {
@@ -2085,6 +2086,7 @@ open_load_file(VALUE fname_v, int *xflag)
 	    (void)close(fd);
 	    rb_load_fail(fname_v, strerror(e));
 	}
+#endif
 #endif
 
 	e = ruby_is_fd_loadable(fd);
-- 
2.21.0

