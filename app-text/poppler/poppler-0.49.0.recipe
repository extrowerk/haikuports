SUMMARY="A PDF rendering library"
DESCRIPTION="Hunspell is a spell checker and morphological analyzer library \
and program designed for languages with rich morphology and complex word \
compounding or character encoding."
HOMEPAGE="https://hunspell.github.io/"
COPYRIGHT="2002-2008 Albert Astals Cid (poppler)
	2001-2002 Derek Noonburg (xpdf)"
LICENSE="GNU GPL v2"
REVISION="1"
SOURCE_URI="https://github.com/hunspell/hunspell/archive/poppler-$portVersion.tar.xz"
CHECKSUM_SHA256="14485f0e1e43dcddf49cfc02c2ccb92910ba3e0e91e06f4bd2642ec00cb3a79f"
#PATCHES="hunspell-$portVersion.patchset"

ARCHITECTURES="!x86_gcc2 x86 x86_64"
SECONDARY_ARCHITECTURES="x86"

PROVIDES="
	$portName = $portVersion
	lib:libpoppler$secondaryArchSuffix = 65.0.0
	lib:libpoppler_cpp$secondaryArchSuffix = 0.3.0
	lib:libpoppler_glib$secondaryArchSuffix = 8.8.0
	lib:libpoppler_qt5$secondaryArchSuffix = 1.7.0
	cmd:pdfdetach$secondaryArchSuffix
	cmd:pdfimages$secondaryArchSuffix
	cmd:pdfseparate$secondaryArchSuffix
	cmd:pdftohtml$secondaryArchSuffix
	cmd:pdftops$secondaryArchSuffix
	cmd:pdfunite$secondaryArchSuffix
	cmd:pdffonts$secondaryArchSuffix
	cmd:pdfinfo$secondaryArchSuffix
	cmd:pdftocairo$secondaryArchSuffix
	cmd:pdftoppm$secondaryArchSuffix
	cmd:pdftotext$secondaryArchSuffix
	"
REQUIRES="
	haiku$secondaryArchSuffix
	qt5${secondaryArchSuffix}
	lib:libcairo$secondaryArchSuffix
	lib:libcurl$secondaryArchSuffix
	lib:libfontconfig$secondaryArchSuffix
	lib:libfreetype$secondaryArchSuffix
	lib:libgio_2.0$secondaryArchSuffix
	lib:libglib_2.0$secondaryArchSuffix
	lib:libgobject_2.0$secondaryArchSuffix
	lib:libiconv$secondaryArchSuffix
	lib:libintl$secondaryArchSuffix
	lib:libjpeg$secondaryArchSuffix
	lib:liblcms2$secondaryArchSuffix
	#lib:libnss3$secondaryArchSuffix requires nss3.pc
	lib:libopenjp2$secondaryArchSuffix
	lib:libpng16$secondaryArchSuffix
	lib:libtiff$secondaryArchSuffix
	lib:libz$secondaryArchSuffix
	"

PROVIDES_devel="
	poppler${secondaryArchSuffix}_devel = $portVersion
	devel:libpoppler$secondaryArchSuffix = 65.0.0
	devel:libpoppler_cpp$secondaryArchSuffix = 0.3.0
	devel:libpoppler_glib$secondaryArchSuffix = 8.8.0
	devel:libpoppler_qt5$secondaryArchSuffix = 1.7.0
	"
REQUIRES_devel="
	poppler$secondaryArchSuffix == $portVersion base
	"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	qt5${secondaryArchSuffix}_devel
	devel:libcairo$secondaryArchSuffix
	devel:libcurl$secondaryArchSuffix
	devel:libfontconfig$secondaryArchSuffix
	devel:libfreetype$secondaryArchSuffix
	devel:libgio_2.0$secondaryArchSuffix
	devel:libglib_2.0$secondaryArchSuffix
	devel:libgobject_2.0$secondaryArchSuffix
	devel:libiconv$secondaryArchSuffix
	devel:libintl$secondaryArchSuffix
	devel:libjpeg$secondaryArchSuffix
	devel:liblcms2$secondaryArchSuffix
	#devel:libnss3$secondaryArchSuffix requires nss3.pc
	devel:libopenjp2$secondaryArchSuffix
	devel:libpng16$secondaryArchSuffix
	devel:libtiff$secondaryArchSuffix
	devel:libz$secondaryArchSuffix

	"
BUILD_PREREQUIRES="
	cmd:aclocal
	cmd:autoconf
	cmd:automake
	cmd:gawk
	cmd:grep
	cmd:gcc$secondaryArchSuffix
	cmd:ld$secondaryArchSuffix
	cmd:libtoolize$secondaryArchSuffix
	cmd:make
	cmd:pkg_config$secondaryArchSuffix
	cmd:sed
	"

BUILD()
{
	export CFLAGS="-D_BSD_SOURCE"
	export CXXFLAGS="-D_BSD_SOURCE"
	export LDFLAGS="-lnetwork -lbsd"

#	libtoolize --force --copy --install
#	aclocal -I m4
#	autoconf
#	automake --add-missing
#	runConfigure --omit-dirs docDir ./configure \
#		--docdir=$docDir \
#		--enable-xpdf-headers \
#		--enable-build-type=release \
#		--enable-cmyk \
#		--enable-libcurl \
#		--enable-cms=auto
#		
#	make $jobArgs
true
}

INSTALL()
{
	make install

	rm -rf $libDir/*.la

	prepareInstalledDevelLibs libpoppler libpoppler-cpp libpoppler-glib libpoppler-qt5
	fixPkgconfig

	packageEntries devel \
		$developDir
}

TEST()
{
	make check
}
