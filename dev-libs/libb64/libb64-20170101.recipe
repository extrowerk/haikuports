SUMMARY="Base64 Encoding/Decoding Routines"
DESCRIPTION="libb64 is a library of ANSI C routines for fast \
encoding/decoding data into and from a base64-encoded format. C++ wrappers \
are included, as well as the source code for standalone encoding and \
decoding executables.

base64 consists of ASCII text, and is therefore a useful encoding for storing \
binary data in a text file, such as xml, or sending binary data over \
text-only email."
HOMEPAGE="https://github.com/transmission/libb64"
COPYRIGHT="Chris Venter"
LICENSE="Public Domain"
REVISION="1"
srcGitRev="8456a5b5c99ef4544a2ed8e8f20a2fb673dd4192"
SOURCE_URI="https://github.com/transmission/libb64/archive/$srcGitRev.zip"
SOURCE_FILENAME="libb64-$portVersion.zip"
CHECKSUM_SHA256="43b596e5a6be063b2aaf86f618a6f19b7fb6e301da02c3ba72a7900106e8bd57"
SOURCE_DIR="libb64-$srcGitRev"
PATCHES="libb64-$portVersion.patchset"

ARCHITECTURES="?x86_gcc2 ?x86 x86_64"
SECONDARY_ARCHITECTURES="?x86"

PROVIDES="
	libb64$secondaryArchSuffix = $portVersion
	lib:libb64$secondaryArchSuffix = $portVersion
	"
REQUIRES="
	haiku$secondaryArchSuffix
	"

PROVIDES_devel="
	libb64${secondaryArchSuffix}_devel = $portVersion
	devel:libb64$secondaryArchSuffix = $portVersion
	"
REQUIRES_devel="
	libb64$secondaryArchSuffix == $portVersion base
	"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	"
BUILD_PREREQUIRES="
	cmd:cmake
	cmd:gcc$secondaryArchSuffix
	cmd:make
	"

BUILD()
{
	mkdir -p build && cd "$_"
	cmake \
		-DCMAKE_INSTALL_PREFIX=$prefix \
		-DCMAKE_BUILD_TYPE=release \
		-Wno-dev \
		..
	make $jobArgs
}

INSTALL()
{
	make -C build install

	mkdir -p $includeDir
	mv $prefix/include/* $includeDir
	rmdir $prefix/include

	if [ -n "$secondaryArchSuffix" ]; then
		mv $prefix/lib $prefix/lib2
		mkdir -p $libDir
		mv $prefix/lib2/* $libDir/
		rmdir $prefix/lib2
	fi
	prepareInstalledDevelLibs libb64
	packageEntries devel \
		$developDir
}
